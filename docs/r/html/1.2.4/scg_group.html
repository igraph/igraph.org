




<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="/favicon.ico" type="image/png" />

    <title>igraph R manual pages</title>

    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom styles for this template -->
    <link href="//fonts.googleapis.com/css?family=Lato:300,400,700"
          rel="stylesheet" type="text/css">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/fonts/font-mfizz/font-mfizz.css">
    <link href="/css/affix.css" rel="stylesheet">
    <link href="/css/syntax.css" rel="stylesheet">
    <link href="/css/other.css" rel="stylesheet">
    <link href="/fonts/fonts.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements 
         and media queries -->
    <!--[if lt IE 9]>
      <script src="/js/html5shiv.js"></script>
      <script src="/js/respond.min.js"></script>
    <![endif]-->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-1392972-5"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-1392972-5');
    </script>

    <link href="/css/manual.css" rel="stylesheet">
  </head>

  <body class="r">
  <div id="wrap">
    <nav class="navbar navbar-expand-md navbar-dark bg-dark fixed-top">
      <a class="navbar-brand" href="/">
        <img src="/img/igraph_logo_white.svg" width="35"> igraph
      </a>

      
      <ul class="navbar-nav mr-auto">
        
        <li class="nav-item"><a class="nav-link" href="/r">igraph R package</a></li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#">
            1.2.4
          </a>
          <div class="dropdown-menu">
            <a class="dropdown-item" href="/r/html/latest/">latest</a>
            
            <a class="dropdown-item" href="/r/html/1.2.6/">1.2.6</a>
            
            <a class="dropdown-item" href="/r/html/1.2.5/">1.2.5</a>
            
            <a class="dropdown-item" href="/r/html/1.2.4/">1.2.4</a>
            
            <a class="dropdown-item" href="/r/html/1.2.3/">1.2.3</a>
            
          </div>
        </li>
        
      </ul>
      

      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav ml-auto">
          <li class="nav-item dropdown">
            <a href="#" class="nav-link dropdown-toggle" id="productsDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Products</a>
            <div class="dropdown-menu" aria-labelledby="productsDropdown">
              <a class="dropdown-item" href="/r">igraph R package</a>
              <a class="dropdown-item" href="/python">python-igraph</a>
              <a class="dropdown-item" href="http://szhorvat.net/mathematica/IGraphM">IGraph/M</a>
              <a class="dropdown-item" href="/c">igraph C library</a>
              <div class="dropdown-divider"></div>
              <a class="dropdown-item" href="https://github.com/igraph/igraphdata">igraphdata R package <i class="fa fa-github"></i></a>
            </div>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/news.html"><i class="fa fa-rss"></i> News</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="https://igraph.discourse.group"><i class="fa fa-comments"></i> Forum</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/code-of-conduct.html"><i class="fa fa-gavel"></i> Code of Conduct</a>
          </li>          
          <li class="nav-item">
            <a class="nav-link" href="https://github.com/igraph"><i class="fa fa-github"></i> On GitHub</a>
          </li>
        </ul>
      </div>
    </nav>
    
    

    <div class="jumbotron">
      <div class="container">
        <h1 class="display-4">R igraph manual pages</h1>
        <p class="lead">Use this if you are using igraph from R</p>
      </div>
      <canvas id="jumbotron-anim"></canvas>
    </div>

    

    <div class="container">
  <div class="row">
    <div class="col-md-12">
      <div class="bs-docs-section">
        


<h2>SCG Problem Solver</h2>

<h3>Description</h3>

<p>This function solves the Spectral Coarse Graining (SCG) problem; either
exactly, or approximately but faster.
</p>


<h3>Usage</h3>

<pre>
scg_group(V, nt, mtype = c("symmetric", "laplacian", "stochastic"),
  algo = c("optimum", "interv_km", "interv", "exact_scg"), p = NULL,
  maxiter = 100)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>V</code></td>
<td>
<p>A numeric matrix of (eigen)vectors to be preserved by the coarse
graining (the vectors are to be stored column-wise in <code>V</code>).</p>
</td></tr>
<tr valign="top"><td><code>nt</code></td>
<td>
<p>A vector of positive integers of length one or equal to
<code>length(ev)</code>. When <code>algo</code> = &ldquo;optimum&rdquo;, <code>nt</code> contains
the number of groups used to partition each eigenvector separately. When
<code>algo</code> is equal to &ldquo;interv\_km&rdquo; or &ldquo;interv&rdquo;, <code>nt</code>
contains the number of intervals used to partition each eigenvector. The
same partition size or number of intervals is used for each eigenvector if
<code>nt</code> is a single integer. When <code>algo</code> = &ldquo;exact\_cg&rdquo; this
parameter is ignored.</p>
</td></tr>
<tr valign="top"><td><code>mtype</code></td>
<td>
<p>The type of semi-projectors used in the SCG. For now
&ldquo;symmetric&rdquo;, &ldquo;laplacian&rdquo; and &ldquo;stochastic&rdquo; are
available.</p>
</td></tr>
<tr valign="top"><td><code>algo</code></td>
<td>
<p>The algorithm used to solve the SCG problem. Possible values are
&ldquo;optimum&rdquo;, &ldquo;interv\_km&rdquo;, &ldquo;interv&rdquo; and
&ldquo;exact\_scg&rdquo;.</p>
</td></tr>
<tr valign="top"><td><code>p</code></td>
<td>
<p>A probability vector of length equal to <code>nrow(V)</code>. <code>p</code> is
the stationary probability distribution of a Markov chain when <code>mtype</code>
= &ldquo;stochastic&rdquo;. This parameter is ignored in all other cases.</p>
</td></tr>
<tr valign="top"><td><code>maxiter</code></td>
<td>
<p>A positive integer giving the maximum number of iterations of
the k-means algorithm when <code>algo</code> = &ldquo;interv\_km&rdquo;. This parameter
is ignored in all other cases.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The algorithm &ldquo;optimum&rdquo; solves exactly the SCG problem for each
eigenvector in <code>V</code>. The running time of this algorithm is <i>O(max(nt) m^2)</i> for the symmetric and laplacian matrix
problems (i.e. when <code>mtype</code> is &ldquo;symmetric&rdquo; or
&ldquo;laplacian&rdquo;. It is <i>O(m^3)</i> for the stochastic problem. Here
<i>m</i> is the number of rows in <code>V</code>.  In all three cases, the memory
usage is <i>O(m^2)</i>.
</p>
<p>The algorithms &ldquo;interv&rdquo; and &ldquo;interv\_km&rdquo; solve approximately
the SCG problem by performing a (for now) constant binning of the components
of the eigenvectors, that is <code>nt[i]</code> constant-size bins are used to
partition <code>V[,i]</code>. When <code>algo</code> = &ldquo;interv\_km&rdquo;, the (Lloyd)
k-means algorithm is run on each partition obtained by &ldquo;interv&rdquo; to
improve accuracy.
</p>
<p>Once a minimizing partition (either exact or approximate) has been found for
each eigenvector, the final grouping is worked out as follows: two vertices
are grouped together in the final partition if they are grouped together in
each minimizing partition. In general the size of the final partition is not
known in advance when <code>ncol(V)</code>&gt;1.
</p>
<p>Finally, the algorithm &ldquo;exact\_scg&rdquo; groups the vertices with equal
components in each eigenvector. The last three algorithms essentially have
linear running time and memory load.
</p>


<h3>Value</h3>

<p>A vector of <code>nrow(V)</code> integers giving the group label of each
object (vertex) in the partition.
</p>


<h3>Author(s)</h3>

<p>David Morton de Lachapelle <a href="mailto:david.morton@epfl.ch">david.morton@epfl.ch</a>,
<a href="mailto:david.mortondelachapelle@swissquote.ch">david.mortondelachapelle@swissquote.ch</a>
</p>


<h3>References</h3>

<p>D. Morton de Lachapelle, D. Gfeller, and P. De Los Rios,
Shrinking Matrices while Preserving their Eigenpairs with Application to the
Spectral Coarse Graining of Graphs. Submitted to <em>SIAM Journal on
Matrix Analysis and Applications</em>, 2008.
<a href="http://people.epfl.ch/david.morton">http://people.epfl.ch/david.morton</a>
</p>


<h3>See Also</h3>

<p><a href="scg-method.html">scg-method</a> for a detailed introduction. <code><a href="scg.html">scg</a></code>,
<code><a href="scg_eps.html">scg_eps</a></code>
</p>


<h3>Examples</h3>

<pre>


## We are not running these examples any more, because they
## take a long time to run and this is against the CRAN repository
## policy. Copy and paste them by hand to your R prompt if
## you want to run them.

## Not run: 
# eigenvectors of a random symmetric matrix
M &lt;- matrix(rexp(10^6), 10^3, 10^3)
M &lt;- (M + t(M))/2
V &lt;- eigen(M, symmetric=TRUE)$vectors[,c(1,2)]

# displays size of the groups in the final partition
gr &lt;- scg_group(V, nt=c(2,3))
col &lt;- rainbow(max(gr))
plot(table(gr), col=col, main="Group size", xlab="group", ylab="size")

## comparison with the grouping obtained by kmeans
## for a partition of same size
gr.km &lt;- kmeans(V,centers=max(gr), iter.max=100, nstart=100)$cluster
op &lt;- par(mfrow=c(1,2))
plot(V[,1], V[,2], col=col[gr],
	main = "SCG grouping",
	xlab = "1st eigenvector",
	ylab = "2nd eigenvector")
plot(V[,1], V[,2], col=col[gr.km],
	main = "K-means grouping",
	xlab = "1st eigenvector",
	ylab = "2nd eigenvector")
par(op)
## kmeans disregards the first eigenvector as it
## spreads a much smaller range of values than the second one

### comparing optimal and k-means solutions
### in the one-dimensional case.
x &lt;- rexp(2000, 2)
gr.true &lt;- scg_group(cbind(x), 100)
gr.km &lt;- kmeans(x, 100, 100, 300)$cluster
scg_eps(cbind(x), gr.true)
scg_eps(cbind(x), gr.km)

## End(Not run)

</pre>

<hr /><div style="text-align: center;">[Package <em>igraph</em> version 1.2.4 <a href="index.html">Index</a>]</div>


      </div>
    </div>
  </div>
</div>


    </div>

    <div id="footer"><div class="container-fluid">
      <p class="text-muted credit">
      &copy; 2003 &ndash; 2020 The igraph core team.
            &bull; Code licensed under 
            <a href="http://www.gnu.org/licenses/gpl-2.0.html">
            GNU GPL 2</a> or later, documentation under 
            <a href="http://www.gnu.org/copyleft/fdl.html">
              GNU FDL.</a>
      </p>
    </div></div>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>

    <script src="/js/affix.js"></script>
    <script src="/js/jumbotron.js"></script>
    <script src="/js/toggle.js"></script>

    
  </body>
</html>
