




<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Favicon and theming -->
    <meta name="theme-color" content="#ffffff" />
    <link rel="icon" href="/favicon.svg" />
    <link rel="alternate icon" href="/favicon.ico" />

    <title>igraph R manual pages</title>

    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom styles for this template -->
    <link href="//fonts.googleapis.com/css?family=Lato:300,400,700"
          rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.1/css/fontawesome.min.css" integrity="sha384-QYIZto+st3yW+o8+5OHfT6S482Zsvz2WfOzpFSXMF9zqeLcFV0/wlZpMtyFcZALm" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.1/css/solid.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.1/css/brands.min.css">
    <link rel="stylesheet" href="/fonts/font-mfizz/font-mfizz.css">
    <link href="/css/affix.css" rel="stylesheet">
    <link href="/css/syntax.css" rel="stylesheet">
    <link href="/css/other.css" rel="stylesheet">
    <link href="/fonts/fonts.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements 
         and media queries -->
    <!--[if lt IE 9]>
      <script src="/js/html5shiv.js"></script>
      <script src="/js/respond.min.js"></script>
    <![endif]-->

    <!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-DY4MJME11Z"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());

	  gtag('config', 'G-DY4MJME11Z');
	</script>

    <link href="/css/manual.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js" onload="processMathHTML();"></script>

  </head>

  <body class="r">
  <div id="wrap">
    <nav class="navbar navbar-expand-md navbar-dark bg-dark fixed-top">
      <a class="navbar-brand" href="/">
        <img src="/img/igraph_logo_white.svg" width="35"> igraph
      </a>

      
      <ul class="navbar-nav mr-auto">
        
        <li class="nav-item"><a class="nav-link" href="/r">igraph R package</a></li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#">
            1.2.5
          </a>
          <div class="dropdown-menu" id="doc-version-switcher">
            <a class="dropdown-item" href="#">Please wait...</a>
          </div>
        </li>
        
      </ul>
      

      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav ml-auto">
          <li class="nav-item dropdown">
            <a href="#" class="nav-link dropdown-toggle" id="productsDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Products</a>
            <div class="dropdown-menu" aria-labelledby="productsDropdown">
              <a class="dropdown-item" href="https://r.igraph.org">igraph R package</a>
              <a class="dropdown-item" href="https://python.igraph.org">python-igraph</a>
              <a class="dropdown-item" href="http://szhorvat.net/mathematica/IGraphM">IGraph/M</a>
              <a class="dropdown-item" href="/c">igraph C library</a>
              <div class="dropdown-divider"></div>
              <a class="dropdown-item" href="https://github.com/igraph/igraphdata">igraphdata R package <i class="fa-brands fa-github"></i></a>
            </div>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/news.html"><i class="fa-solid fa-rss"></i> News</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="https://igraph.discourse.group"><i class="fa-solid fa-comments"></i> Forum</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/code-of-conduct.html"><i class="fa-solid fa-gavel"></i> Code of Conduct</a>
          </li>          
          <li class="nav-item">
            <a class="nav-link" href="https://github.com/igraph"><i class="fa-brands fa-github"></i> On GitHub</a>
          </li>
        </ul>
      </div>
    </nav>
    
    

    <div class="jumbotron">
      <div class="container">
        <h1 class="display-4">R igraph manual pages</h1>
        <p class="lead">Use this if you are using igraph from R</p>
      </div>
      <canvas id="jumbotron-anim"></canvas>
    </div>

    

    <div class="container">
  <div class="row">
    <div class="col-md-12">
      <div class="bs-docs-section">
        


<h2>The Davidson-Harel layout algorithm</h2>

<h3>Description</h3>

<p>Place vertices of a graph on the plane, according to the simulated annealing
algorithm by Davidson and Harel.
</p>


<h3>Usage</h3>

<pre>
layout_with_dh(
  graph,
  coords = NULL,
  maxiter = 10,
  fineiter = max(10, log2(vcount(graph))),
  cool.fact = 0.75,
  weight.node.dist = 1,
  weight.border = 0,
  weight.edge.lengths = edge_density(graph)/10,
  weight.edge.crossings = 1 - sqrt(edge_density(graph)),
  weight.node.edge.dist = 0.2 * (1 - edge_density(graph))
)

with_dh(...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>graph</code></td>
<td>
<p>The graph to lay out. Edge directions are ignored.</p>
</td></tr>
<tr valign="top"><td><code>coords</code></td>
<td>
<p>Optional starting positions for the vertices. If this argument
is not <code>NULL</code> then it should be an appropriate matrix of starting
coordinates.</p>
</td></tr>
<tr valign="top"><td><code>maxiter</code></td>
<td>
<p>Number of iterations to perform in the first phase.</p>
</td></tr>
<tr valign="top"><td><code>fineiter</code></td>
<td>
<p>Number of iterations in the fine tuning phase.</p>
</td></tr>
<tr valign="top"><td><code>cool.fact</code></td>
<td>
<p>Cooling factor.</p>
</td></tr>
<tr valign="top"><td><code>weight.node.dist</code></td>
<td>
<p>Weight for the node-node distances component of the
energy function.</p>
</td></tr>
<tr valign="top"><td><code>weight.border</code></td>
<td>
<p>Weight for the distance from the border component of
the energy function. It can be set to zero, if vertices are allowed to sit
on the border.</p>
</td></tr>
<tr valign="top"><td><code>weight.edge.lengths</code></td>
<td>
<p>Weight for the edge length component of the
energy function.</p>
</td></tr>
<tr valign="top"><td><code>weight.edge.crossings</code></td>
<td>
<p>Weight for the edge crossing component of the
energy function.</p>
</td></tr>
<tr valign="top"><td><code>weight.node.edge.dist</code></td>
<td>
<p>Weight for the node-edge distance component of
the energy function.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>Passed to <code>layout_with_dh</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function implements the algorithm by Davidson and Harel, see Ron
Davidson, David Harel: Drawing Graphs Nicely Using Simulated Annealing. ACM
Transactions on Graphics 15(4), pp. 301-331, 1996.
</p>
<p>The algorithm uses simulated annealing and a sophisticated energy function,
which is unfortunately hard to parameterize for different graphs. The
original publication did not disclose any parameter values, and the ones
below were determined by experimentation.
</p>
<p>The algorithm consists of two phases, an annealing phase, and a fine-tuning
phase. There is no simulated annealing in the second phase.
</p>
<p>Our implementation tries to follow the original publication, as much as
possible. The only major difference is that coordinates are explicitly kept
within the bounds of the rectangle of the layout.
</p>


<h3>Value</h3>

<p>A two- or three-column matrix, each row giving the coordinates of a
vertex, according to the ids of the vertex ids.
</p>


<h3>Author(s)</h3>

<p>Gabor Csardi <a href="mailto:csardi.gabor@gmail.com">csardi.gabor@gmail.com</a>
</p>


<h3>References</h3>

<p>Ron Davidson, David Harel: Drawing Graphs Nicely Using Simulated
Annealing. <em>ACM Transactions on Graphics</em> 15(4), pp. 301-331, 1996.
</p>


<h3>See Also</h3>

<p><code><a href="layout_with_fr.html">layout_with_fr</a></code>,
<code><a href="layout_with_kk.html">layout_with_kk</a></code> for other layout algorithms.
</p>
<p>Other graph layouts: 
<code><a href="add_layout_.html">add_layout_</a>()</code>,
<code><a href="component_wise.html">component_wise</a>()</code>,
<code><a href="layout_as_bipartite.html">layout_as_bipartite</a>()</code>,
<code><a href="layout_as_star.html">layout_as_star</a>()</code>,
<code><a href="layout_as_tree.html">layout_as_tree</a>()</code>,
<code><a href="layout_in_circle.html">layout_in_circle</a>()</code>,
<code><a href="layout_nicely.html">layout_nicely</a>()</code>,
<code><a href="layout_on_grid.html">layout_on_grid</a>()</code>,
<code><a href="layout_on_sphere.html">layout_on_sphere</a>()</code>,
<code><a href="layout_randomly.html">layout_randomly</a>()</code>,
<code><a href="layout_with_fr.html">layout_with_fr</a>()</code>,
<code><a href="layout_with_gem.html">layout_with_gem</a>()</code>,
<code><a href="layout_with_graphopt.html">layout_with_graphopt</a>()</code>,
<code><a href="layout_with_kk.html">layout_with_kk</a>()</code>,
<code><a href="layout_with_lgl.html">layout_with_lgl</a>()</code>,
<code><a href="layout_with_mds.html">layout_with_mds</a>()</code>,
<code><a href="layout_with_sugiyama.html">layout_with_sugiyama</a>()</code>,
<code><a href="layout_.html">layout_</a>()</code>,
<code><a href="merge_coords.html">merge_coords</a>()</code>,
<code><a href="norm_coords.html">norm_coords</a>()</code>,
<code><a href="normalize.html">normalize</a>()</code>
</p>


<h3>Examples</h3>

<pre>

set.seed(42)
## Figures from the paper
g_1b &lt;- make_star(19, mode="undirected") + path(c(2:19, 2)) +
  path(c(seq(2, 18, by=2), 2))
plot(g_1b, layout=layout_with_dh)

g_2 &lt;- make_lattice(c(8, 3)) + edges(1,8, 9,16, 17,24)
plot(g_2, layout=layout_with_dh)

g_3 &lt;- make_empty_graph(n=70)
plot(g_3, layout=layout_with_dh)

g_4 &lt;- make_empty_graph(n=70, directed=FALSE) + edges(1:70)
plot(g_4, layout=layout_with_dh, vertex.size=5, vertex.label=NA)

g_5a &lt;- make_ring(24)
plot(g_5a, layout=layout_with_dh, vertex.size=5, vertex.label=NA)

g_5b &lt;- make_ring(40)
plot(g_5b, layout=layout_with_dh, vertex.size=5, vertex.label=NA)

g_6 &lt;- make_lattice(c(2,2,2))
plot(g_6, layout=layout_with_dh)

g_7 &lt;- graph_from_literal(1:3:5 -- 2:4:6)
plot(g_7, layout=layout_with_dh, vertex.label=V(g_7)$name)

g_8 &lt;- make_ring(5) + make_ring(10) + make_ring(5) +
  edges(1,6, 2,8, 3, 10, 4,12, 5,14,
        7,16, 9,17, 11,18, 13,19, 15,20)
plot(g_8, layout=layout_with_dh, vertex.size=5, vertex.label=NA)

g_9 &lt;- make_lattice(c(3,2,2))
plot(g_9, layout=layout_with_dh, vertex.size=5, vertex.label=NA)

g_10 &lt;- make_lattice(c(6,6))
plot(g_10, layout=layout_with_dh, vertex.size=5, vertex.label=NA)

g_11a &lt;- make_tree(31, 2, mode="undirected")
plot(g_11a, layout=layout_with_dh, vertex.size=5, vertex.label=NA)

g_11b &lt;- make_tree(21, 4, mode="undirected")
plot(g_11b, layout=layout_with_dh, vertex.size=5, vertex.label=NA)

g_12 &lt;- make_empty_graph(n=37, directed=FALSE) +
  path(1:5,10,22,31,37:33,27,16,6,1) + path(6,7,11,9,10) + path(16:22) +
  path(27:31) + path(2,7,18,28,34) + path(3,8,11,19,29,32,35) +
  path(4,9,20,30,36) + path(1,7,12,14,19,24,26,30,37) +
  path(5,9,13,15,19,23,25,28,33) + path(3,12,16,25,35,26,22,13,3)
plot(g_12,  layout=layout_with_dh, vertex.size=5, vertex.label=NA)
</pre>

<hr /><div style="text-align: center;">[Package <em>igraph</em> version 1.2.5 <a href="index.html">Index</a>]</div>


      </div>
    </div>
  </div>
</div>


    </div>

    <div id="footer"><div class="container-fluid">
      <p class="text-muted credit">
	      &copy; 2003 &ndash; 2024 The igraph core team.
        &bull; Code licensed under <a href="http://www.gnu.org/licenses/gpl-2.0.html"> GNU GPL 2</a> or later,
        documentation under <a href="http://www.gnu.org/copyleft/fdl.html">GNU FDL</a>.
      </p>
      <p class="social">
        <a href="https://twitter.com/igraph2"><i class="fa-brands fa-twitter"></i></a>
        <a rel="me" href="https://fosstodon.org/@igraph"><i class="fa-brands fa-mastodon"></i></a>
      </p>
    </div></div>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>

    <script src="/js/affix.js"></script>
    <script src="/js/jumbotron.js"></script>
    <script src="/js/toggle.js"></script>


    <script src="/js/doc-version-switcher.js"></script>
    <script>
        generateVersionSwitcher('#doc-version-switcher', 'r', 'html/');
    </script>





    
  </body>
</html>
